This is almost a direct copy from https://github.com/jatinchowdhury18/RTNeural-NAM

There is a change to allow load_weights to be called
